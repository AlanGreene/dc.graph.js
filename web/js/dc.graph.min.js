/*!
 *  dc.graph 0.1.0
 *  http://dc-js.github.io/dc.graph.js/
 *  Copyright 2015 Gordon Woodhull
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

!function(){function a(a,b,c){"use strict";var d={version:"0.1.0"},e=function(a){var b=a,c=null,d=function(a){return arguments.length?(b=a,c&&c(),this):b};return d.react=function(a){return arguments.length?(c=a,this):c},d};return d.diagram=function(b,d){function f(){r=cola.d3adaptor().avoidOverlaps(!0).size([m.width(),m.height()]),m.modLayout()&&m.modLayout()(r)}function g(a){return function(b){return a(b.orig)}}function h(a){return"edge-"+g(m.edgeKeyAccessor())(a).replace(/[^\w-_]/g,"-")}function i(a){var b=a.target.x-a.source.x,c=a.target.y-a.source.y,d=Math.sqrt(b*b+c*c),e=b/d,f=c/d,h=g(m.nodeRadiusAccessor())(a.source)+g(m.nodeStrokeWidthAccessor())(a.source)/2,i=g(m.nodeRadiusAccessor())(a.target)+g(m.nodeStrokeWidthAccessor())(a.target)/2,j=a.source.x+h*e,k=a.source.y+h*f,l=a.target.x-i*e,n=a.target.y-i*f;return a.length=Math.hypot(l-j,n-k),"M"+j+","+k+"L"+l+","+n}function j(a,b,c,d){a.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),b.attr("d",i),c.attr("d",i),d.attr("transform",function(a){if(a.target.x<a.source.x){var b=this.getBBox(),c=b.x+b.width/2,d=b.y+b.height/2;return"rotate(180 "+c+" "+d+")"}return"rotate(0)"}).attr("dy",function(a){return a.target.x<a.source.x?11:-2})}function k(){o.attr("transform","translate("+a.event.translate+") scale("+a.event.scale+")")}function l(){return n=m.root().append("svg").attr("width",m.width()).attr("height",m.height()),m.defineArrow("vee",12,12,10,0,function(a){a.append("svg:path").attr("d","M0,-5 L10,0 L0,5 L3,0").attr("stroke-width","0px")}),m.defineArrow("dot",7,7,0,0,function(a){a.append("svg:circle").attr("r",5).attr("cx",5).attr("cy",0).attr("stroke-width","0px")}),m.zoomable()&&n.call(a.behavior.zoom().on("zoom",k)),n}var m={},n=null,o=null,p=null,q=null,r=null,s=25,t=a.dispatch("end");m.root=e(null),m.width=e(200),m.height=e(200),m.zoomable=e(!0),m.nodeDimension=e(),m.nodeGroup=e(),m.edgeDimension=e(),m.edgeGroup=e(),m.nodeKeyAccessor=e(function(a){return a.key}),m.edgeKeyAccessor=e(function(a){return a.key}),m.sourceAccessor=e(),m.targetAccessor=e(),m.nodeRadiusAccessor=e(function(){return s}),m.nodeStrokeWidthAccessor=e(function(){return"1"}),m.nodeStrokeAccessor=e(function(){return"black"}),m.nodeFillAccessor=e(function(){return"white"}),m.nodePadding=e(6),m.nodeLabelAccessor=e(function(a){return a.value.label||a.value.name}),m.edgeStrokeAccessor=e(function(){return"black"}),m.edgeStrokeWidthAccessor=e(function(){return"1"}),m.edgeOpacityAccessor=e(function(){return"1"}),m.edgeLabelAccessor=e(function(a){return m.edgeKeyAccessor()(a)}),m.edgeArrowhead=e(function(){return"vee"}),m.edgeArrowtail=e(function(){return null}),m.transitionDuration=e(500),m.constrain=e(function(){return[]}),m.initLayoutOnRedraw=e(!1),m.modLayout=e(function(){}),m.showLayoutSteps=e(!0);var u={},v={};return m.redraw=function(){m.initLayoutOnRedraw()&&f();var b=m.nodeGroup().all(),c=m.edgeGroup().all();r&&r.stop();var d=b.reduce(function(a,b,c){return a[m.nodeKeyAccessor()(b)]=c,a},{}),e=b.map(function(a){u[a.key]||(u[a.key]={});var b=u[a.key];return b.orig=a,b.width=2*m.nodeRadiusAccessor()(a)+m.nodePadding(),b.height=2*m.nodeRadiusAccessor()(a)+m.nodePadding(),b}),i=c.map(function(a){v[a.key]||(v[a.key]={});var b=v[a.key];return b.orig=a,b.source=d[m.sourceAccessor()(a)],b.target=d[m.targetAccessor()(a)],b}).filter(function(a){return void 0!==a.source&&void 0!==a.target}),k=q.selectAll(".edge").data(i,g(m.edgeKeyAccessor())),l=(k.enter().append("svg:path").attr("class","edge").attr("id",h).attr("stroke",g(m.edgeStrokeAccessor())).attr("stroke-width",g(m.edgeStrokeWidthAccessor())).attr("opacity",g(m.edgeOpacityAccessor())).attr("marker-end",function(a){return"url(#"+g(m.edgeArrowhead())(a)+")"}).attr("marker-start",function(a){return"url(#"+g(m.edgeArrowtail())(a)+")"}),k.exit());l.remove();var n=q.selectAll(".edge-hover").data(i,g(m.edgeKeyAccessor()));n.enter().append("svg:path").attr("class","edge-hover").attr("opacity",0).attr("stroke","green").attr("stroke-width",10).on("mouseover",function(b){a.select("#"+h(b)+"-label").attr("visibility","visible")}).on("mouseout",function(b){a.select("#"+h(b)+"-label").attr("visibility","hidden")}),n.exit().remove();{var o=q.selectAll(".edge-label").data(i,g(m.edgeKeyAccessor()));o.enter().append("text").attr("id",function(a){return h(a)+"-label"}).attr("visibility","hidden").attr({"class":"edge-label","text-anchor":"middle",dy:-2}).append("textPath").attr("startOffset","50%").attr("xlink:href",function(a){return"#"+h(a)}).text(function(a){return g(m.edgeLabelAccessor())(a)})}o.exit().remove();var s=p.selectAll(".node").data(e,g(m.nodeKeyAccessor())),w=s.enter().append("g").attr("class","node").call(r.drag);w.append("circle"),w.append("text").attr("class","nodelabel"),s.select("circle").attr("r",g(m.nodeRadiusAccessor())).attr("stroke",g(m.nodeStrokeAccessor())).attr("stroke-width",g(m.nodeStrokeWidthAccessor())).attr("fill",g(m.nodeFillAccessor())),s.select("text").attr("class","node-label").text(g(m.nodeLabelAccessor()));var x=s.exit(),y=m.constrain()(e,i);return x.remove(),r.on("tick",m.showLayoutSteps()?function(){j(s,k,n,o)}:null),r.nodes(e).links(i).constraints(y).start(10,20,20).on("end",function(){m.showLayoutSteps()||j(s,k,n,o),t.end()}),this},m.render=function(){return m.initLayoutOnRedraw()||f(),m.resetSvg(),o=n.append("g"),q=o.append("g"),p=o.append("g"),m.redraw()},m.on=function(a,b){return t.on(a,b),this},m.select=function(a){return m.root().select(a)},m.resetSvg=function(){return m.select("svg").remove(),l()},m.defineArrow=function(a,b,c,d,e,f){n.append("svg:defs").append("svg:marker").attr("id",a).attr("viewBox","0 -5 10 10").attr("refX",d).attr("refY",e).attr("markerWidth",b).attr("markerHeight",c).attr("orient","auto").call(f)},m.root(a.select(b)),c.registerChart(m,d),m},d.load_graph=function(b,c){/\.json$/.test(b)?a.json(b,c):/\.gv|\.dot$/.test(b)&&a.text(b,function(a,b){if(a)return void c(a,null);var d=graphlibDot.parse(b),e=d.nodes(),f=new Array(e.length);e.forEach(function(a,b){var c=f[b]=d._nodes[e[b]];c.id=b,c.name=a});var g=d.edges(),h=[];g.forEach(function(a){var b=d._edges[a];h.push({source:d._nodes[b.u].id,target:d._nodes[b.v].id,sourcename:b.u,targetname:b.v})});var i={nodes:f,links:h};c(null,i)})},d.generate=function(a,b,c){function d(a){if(26>a)return String.fromCharCode(97+a);if(52>a)return String.fromCharCode(65+a-26);if(2704>a)return d(Math.floor(a/52))+d(a%52);throw new Error("no, that's too large")}function e(a){return{id:a,name:d(a)}}function f(a,b,c){return{source:a,target:b,sourcename:g[a].name,targetname:g[b].name,length:c}}var g,h,i,j;switch(a){case"clique":for(g=new Array(b),h=[],i=0;b>i;++i)for(g[i]=e(i),j=0;i>j;++j)h.push(f(i,j));break;case"wheel":var k=15*b,l=Math.floor(b/2),m=2*k*Math.sin(Math.PI/b),n=2*k*Math.sin(l*Math.PI/b);for(g=new Array(b),h=[],i=0;b>i;++i)g[i]=e(i);for(i=0;b>i;++i)h.push(f(i,(i+1)%b,m));for(i=0;b/2>i;++i)h.push(f(i,(i+l)%b,n)),b%2&&i!=Math.floor(b/2)&&h.push(f(i,(i+b-l)%b,n));break;default:throw new Error("unknown generation type "+a)}var o={nodes:g,links:h};c(null,o)},d.d3=a,d.crossfilter=b,d.dc=c,d}if("function"==typeof define&&define.amd)define(["d3","crossfilter","dc"],a);else if("object"==typeof module&&module.exports){var b=require("d3"),c=require("crossfilter");"function"!=typeof c&&(c=c.crossfilter);var d=require("dc");module.exports=a(b,c,d)}else this.dc_graph=a(d3,crossfilter,dc)}();
//# sourceMappingURL=dc.graph.min.js.map