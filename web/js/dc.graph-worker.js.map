{"version":3,"sources":["src/generate_objects.js","src/cola-worker.js"],"names":[],"mappings":"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","file":"dc.graph-worker.js","sourcesContent":["// create or re-use objects in a map, delete the ones that were not reused\nfunction regenerate_objects(preserved, list, key, assign) {\n    var keep = {};\n    function wrap(o) {\n        var k = key(o);\n        if(!preserved[k]) preserved[k] = {};\n        var o1 = preserved[k];\n        assign(o1, o);\n        keep[k] = true;\n        return o1;\n    }\n    var wlist = list.map(wrap);\n    // delete any objects from last round that are no longer used\n    for(var k in preserved)\n        if(!keep[k])\n            delete preserved[k];\n    return wlist;\n}\n","importScripts('cola.js');\nimportScripts('d3.js');\n\nvar _d3cola = null;\n\nfunction init_d3cola(width, height, handleDisconnected, lengthStrategy, baseLength, flowLayout) {\n    _d3cola = cola.d3adaptor()\n        .avoidOverlaps(true)\n        .size([width, height])\n        .handleDisconnected(handleDisconnected);\n\n    switch(lengthStrategy) {\n        case 'symmetric':\n            _d3cola.symmetricDiffLinkLengths(baseLength);\n            break;\n        case 'jaccard':\n            _d3cola.jaccardLinkLengths(baseLength);\n            break;\n        case 'individual':\n            _d3cola.linkDistance(function(e) {\n                return e.dcg_edgeLength || baseLength;\n            });\n            break;\n        case 'none':\n        default:\n    }\n    if(flowLayout) {\n        _d3cola.flowLayout(flowLayout.axis, flowLayout.minSeparation);\n    }\n\n}\n\n// node and edge objects shared with cola.js, preserved from one iteration\n// to the next (as long as the object is still in the layout)\nvar _nodes = {}, _edges = {};\n\nfunction data_d3cola(nodes, edges, constraints) {\n    var wnodes = regenerate_objects(_nodes, nodes, function(v) {\n        return v.dcg_nodeKey;\n    }, function(v1, v) {\n        v1.dcg_nodeKey = v.dcg_nodeKey;\n        v1.width = v.width;\n        v1.height = v.height;\n        if(v.dcg_nodeFixed) {\n            v1.x = v.x;\n            v1.y = v.y;\n            v1.fixed = true;\n        }\n        else\n            v1.fixed = false;\n    });\n    var wedges = regenerate_objects(_edges, edges, function(e) {\n        return e.dcg_edgeKey;\n    }, function(e1, e) {\n        e1.dcg_edgeKey = e.dcg_edgeKey;\n        // cola edges can work with indices or with object references\n        // but it will replace indices with object references\n        e1.source = _nodes[e.dcg_edgeSource];\n        e1.target = _nodes[e.dcg_edgeTarget];\n        e1.dcg_edgeLength = e.dcg_edgeLength;\n    });\n\n    // cola needs each node object to have an index property\n    wnodes.forEach(function(v, i) {\n        v.index = i;\n    });\n\n    function postResponseState(response) {\n        postMessage({\n            response: response,\n            args: {\n                nodes: wnodes,\n                edges: wedges.map(function(e) {\n                    return {dcg_edgeKey: e.dcg_edgeKey};\n                })\n            }\n        });\n    }\n    _d3cola.on('tick', function() {\n        postResponseState('tick');\n    }).on('start', function() {\n        postMessage({response: 'start'});\n    }).on('end', function() {\n        postResponseState('end');\n    });\n    _d3cola.nodes(wnodes)\n        .links(wedges)\n        .constraints(constraints);\n}\n\nfunction start_d3cola(initialUnconstrainedIterations,\n                      initialUserConstraintIterations,\n                      initialAllConstraintsIterations,\n                      gridSnapIterations) {\n    _d3cola.start(initialUnconstrainedIterations,\n                  initialUserConstraintIterations,\n                  initialAllConstraintsIterations,\n                  gridSnapIterations);\n}\n\nfunction stop_d3cola() {\n    _d3cola.stop();\n}\n\nonmessage = function(e) {\n    var args = e.data.args;\n    switch(e.data.command) {\n    case 'init':\n        init_d3cola(args.width, args.height, args.handleDisconnected,\n                    args.lengthStrategy, args.baseLength, args.flowLayout);\n        break;\n    case 'data':\n        data_d3cola(args.nodes, args.edges, args.constraints);\n        break;\n    case 'start':\n        start_d3cola(args.initialUnconstrainedIterations,\n                     args.initialUserConstraintIterations,\n                     args.initialAllConstraintsIterations,\n                     args.gridSnapIterationse);\n        break;\n    case 'stop':\n        stop_d3cola();\n        break;\n    }\n};\n\n"]}