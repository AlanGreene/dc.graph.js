var runner = function(init, step) {
    var timer;
    var stepped, timedOut, stopRequested;

    function kontinue() {
        if(!stepped || !timedOut)
            return;
        timer = null;
        if(!stopRequested)
            step();
        stopRequested = false;
    }

    return {
        init: function() {
        },
        start: function(interval) {
            interval = d3.functor(interval);
            timer = window.setTimeout(function() {
                timedOut = true;
                kontinue();
            });
        },
        stop: function() {
            stopRequested = true;
        },
        endStep: function() {
            stepped = true;
        }
    };
};
