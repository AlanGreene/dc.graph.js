/*!
 *  dc.graph 0.1.0
 *  http://dc-js.github.io/dc.graph.js/
 *  Copyright 2015 Gordon Woodhull
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

!function(){function a(a,b,c){"use strict";var d={version:"0.1.0"},e=function(a){var b=a,c=null,d=function(a){return arguments.length?(b=a,c&&c(),this):b};return d.react=function(a){return arguments.length?(c=a,this):c},d};return d.functor_wrap=function(a,b){return"function"==typeof a?b?function(c){return a(b(c))}:a:function(){return a}},d.diagram=function(b,f){function g(a){return d.functor_wrap(a,function(a){return a.orig})}function h(){switch(t=cola.d3adaptor().avoidOverlaps(!0).size([o.width(),o.height()]),o.lengthStrategy()){case"symmetric":t.symmetricDiffLinkLengths(o.baseLength());break;case"jaccard":t.symmetricDiffLinkLengths(o.baseLength());break;case"individual":t.linkDistance(function(a){var b=a.orig?g(o.edgeDistanceAccessor())(a):a.internal&&a.internal.distance;return b||o.baseLength()});break;case"none":}o.modLayout()&&o.modLayout()(t)}function i(a){return"edge-"+g(o.edgeKeyAccessor())(a).replace(/[^\w-_]/g,"-")}function j(a){var b=a.target.x-a.source.x,c=a.target.y-a.source.y,d=Math.sqrt(b*b+c*c),e=b/d,f=c/d,h=g(o.nodeRadiusAccessor())(a.source)+g(o.nodeStrokeWidthAccessor())(a.source)/2,i=g(o.nodeRadiusAccessor())(a.target)+g(o.nodeStrokeWidthAccessor())(a.target)/2,j=a.source.x+h*e,k=a.source.y+h*f,l=a.target.x-i*e,m=a.target.y-i*f;return a.length=Math.hypot(l-j,m-k),"M"+j+","+k+"L"+l+","+m}function k(a,b,c,d){a.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),b.attr("d",j),c.attr("d",j),d.attr("transform",function(a){if(a.target.x<a.source.x){var b=this.getBBox(),c=b.x+b.width/2,d=b.y+b.height/2;return"rotate(180 "+c+" "+d+")"}return"rotate(0)"}).attr("dy",function(a){return a.target.x<a.source.x?11:-2})}function l(){q.attr("transform","translate("+a.event.translate+") scale("+a.event.scale+")")}function m(){p&&p.attr("width",o.width()).attr("height",o.height())}function n(){return p=o.root().append("svg"),m(),o.defineArrow("vee",12,12,10,0,function(a){a.append("svg:path").attr("d","M0,-5 L10,0 L0,5 L3,0").attr("stroke-width","0px")}),o.defineArrow("dot",7,7,0,0,function(a){a.append("svg:circle").attr("r",5).attr("cx",5).attr("cy",0).attr("stroke-width","0px")}),o.mouseZoomable()&&p.call(a.behavior.zoom().on("zoom",l)),p}var o={},p=null,q=null,r=null,s=null,t=null,u=a.dispatch("end");o.width=e(200).react(m),o.height=e(200).react(m),o.root=e(null),o.mouseZoomable=e(!0),o.nodeDimension=e(),o.nodeGroup=e(),o.edgeDimension=e(),o.edgeGroup=e(),o.nodeKeyAccessor=e(function(a){return a.key}),o.edgeKeyAccessor=e(function(a){return a.key}),o.sourceAccessor=e(),o.targetAccessor=e(),o.nodeRadiusAccessor=e(function(){return 25}),o.nodeStrokeWidthAccessor=e(function(){return"1"}),o.nodeStrokeAccessor=e(function(){return"black"}),o.nodeFillAccessor=e(function(){return"white"}),o.nodePadding=e(6),o.nodeLabelAccessor=e(function(a){return a.value.label||a.value.name}),o.nodeTitleAccessor=e(function(a){return o.nodeKeyAccessor()(a)}),o.edgeStrokeAccessor=e(function(){return"black"}),o.edgeStrokeWidthAccessor=e(function(){return"1"}),o.edgeOpacityAccessor=e(function(){return"1"}),o.edgeLabelAccessor=e(function(a){return o.edgeKeyAccessor()(a)}),o.edgeArrowheadAccessor=e(function(){return"vee"}),o.edgeArrowtailAccessor=e(function(){return null}),o.edgeIsLayoutAccessor=e(function(a){return!a.value.notLayout}),o.lengthStrategy=e("symmetric"),o.edgeDistanceAccessor=e(function(a){return a.value.distance}),o.baseLength=e(30),o.transitionDuration=e(500),o.constrain=e(function(){return[]}),o.offsetParallelEdges=e(!0),o.initLayoutOnRedraw=e(!1),o.modLayout=e(function(){}),o.showLayoutSteps=e(!0);var v={},w={};return o.redraw=function(){function b(a){v[a.key]||(v[o.nodeKeyAccessor()(a)]={});var b=v[o.nodeKeyAccessor()(a)];return b.orig=a,b.width=2*o.nodeRadiusAccessor()(a)+o.nodePadding(),b.height=2*o.nodeRadiusAccessor()(a)+o.nodePadding(),b}function c(a){w[a.key]||(w[o.edgeKeyAccessor()(a)]={});var b=w[o.edgeKeyAccessor()(a)];return b.orig=a,b.source=j[o.sourceAccessor()(a)],b.target=j[o.targetAccessor()(a)],b}var e=o.nodeGroup().all(),f=o.edgeGroup().all();t&&t.stop(),o.initLayoutOnRedraw()&&h();var j=e.reduce(function(a,b,c){return a[o.nodeKeyAccessor()(b)]=c,a},{}),l=e.map(b),m=f.map(c).filter(function(a){return void 0!==a.source&&void 0!==a.target});if(o.offsetParallelEdges()){for(var n=new Array(l.length),p=0;p<n.length;++p){n[p]=new Array(n.length);for(var q=0;q<n.length;++q)n[p][q]=0}m.forEach(function(a){var b=Math.min(a.source,a.target),c=Math.max(a.source,a.target);a.parallel=n[b][c]++})}var x=s.selectAll(".edge").data(m,g(o.edgeKeyAccessor())),y=(x.enter().append("svg:path").attr("class","edge").attr("id",i).attr("stroke",g(o.edgeStrokeAccessor())).attr("stroke-width",g(o.edgeStrokeWidthAccessor())).attr("opacity",g(o.edgeOpacityAccessor())).attr("marker-end",function(a){return"url(#"+g(o.edgeArrowheadAccessor())(a)+")"}).attr("marker-start",function(a){return"url(#"+g(o.edgeArrowtailAccessor())(a)+")"}),x.exit());y.remove();var z=s.selectAll(".edge-hover").data(m,g(o.edgeKeyAccessor()));z.enter().append("svg:path").attr("class","edge-hover").attr("opacity",0).attr("stroke","green").attr("stroke-width",10).on("mouseover",function(b){a.select("#"+i(b)+"-label").attr("visibility","visible")}).on("mouseout",function(b){a.select("#"+i(b)+"-label").attr("visibility","hidden")}),z.exit().remove();{var A=s.selectAll(".edge-label").data(m,g(o.edgeKeyAccessor()));A.enter().append("text").attr("id",function(a){return i(a)+"-label"}).attr("visibility","hidden").attr({"class":"edge-label","text-anchor":"middle",dy:-2}).append("textPath").attr("startOffset","50%").attr("xlink:href",function(a){return"#"+i(a)}).text(function(a){return g(o.edgeLabelAccessor())(a)})}A.exit().remove();var B=r.selectAll(".node").data(l,g(o.nodeKeyAccessor())),C=B.enter().append("g").attr("class","node").call(t.drag);C.append("title").text(g(o.nodeTitleAccessor())),C.append("circle"),C.append("text").attr("class","nodelabel"),B.select("circle").attr("r",g(o.nodeRadiusAccessor())).attr("stroke",g(o.nodeStrokeAccessor())).attr("stroke-width",g(o.nodeStrokeWidthAccessor())).attr("fill",g(o.nodeFillAccessor())),B.select("text").attr("class","node-label").text(g(o.nodeLabelAccessor()));var D=B.exit(),E=o.constrain()(l,m);D.remove(),t.on("tick",o.showLayoutSteps()?function(){k(B,x,z,A)}:null);var F=m.filter(g(o.edgeIsLayoutAccessor())),G=m.filter(function(a){return!g(o.edgeIsLayoutAccessor())(a)});G.forEach(function(a){a.source=l[a.source],a.target=l[a.target]});var H=E.filter(function(a){return"circle"===a.type}),I=E.filter(function(a){return"circle"!==a.type});return H.forEach(function(a){var b=(a.distance||4*o.baseLength())/(2*Math.sin(Math.PI/a.nodes.length)),c=a.nodes.map(function(a){return a.node}),e=function(a){return g(o.nodeKeyAccessor())(l[a])},f=d.wheel_edges(e,c,b).map(function(a){var b={internal:a};return b.source=j[a.sourcename],b.target=j[a.targetname],b});F=F.concat(f)}),t.nodes(l).links(F).constraints(I).start(10,20,20).on("end",function(){o.showLayoutSteps()||k(B,x,z,A),u.end()}),this},o.render=function(){return o.initLayoutOnRedraw()||h(),o.resetSvg(),q=p.append("g"),s=q.append("g"),r=q.append("g"),o.redraw()},o.on=function(a,b){return u.on(a,b),this},o.select=function(a){return o.root().select(a)},o.selectAll=function(a){return o.root()?o.root().selectAll(a):null},o.svg=function(a){return arguments.length?(p=a,o):p},o.resetSvg=function(){return o.select("svg").remove(),n()},o.defineArrow=function(a,b,c,d,e,f){p.append("svg:defs").append("svg:marker").attr("id",a).attr("viewBox","0 -5 10 10").attr("refX",d).attr("refY",e).attr("markerWidth",b).attr("markerHeight",c).attr("orient","auto").call(f)},o.root(a.select(b)),c.registerChart(o,f),o},d.load_graph=function(b,c){/\.json$/.test(b)?a.json(b,c):/\.gv|\.dot$/.test(b)&&a.text(b,function(a,b){if(a)return void c(a,null);var d=graphlibDot.parse(b),e=d.nodes(),f=new Array(e.length);e.forEach(function(a,b){var c=f[b]=d._nodes[e[b]];c.id=b,c.name=a});var g=d.edges(),h=[];g.forEach(function(a){var b=d._edges[a];h.push({source:d._nodes[b.u].id,target:d._nodes[b.v].id,sourcename:b.u,targetname:b.v})});var i={nodes:f,links:h};c(null,i)})},d.node_name=function(a){if(26>a)return String.fromCharCode(97+a);if(52>a)return String.fromCharCode(65+a-26);if(2704>a)return d.node_name(Math.floor(a/52))+d.node_name(a%52);throw new Error("no, that's too large")},d.node_object=function(a,b){return b=b||{},_.extend({id:a,name:d.node_name(a)},b)},d.edge_object=function(a,b,c,d){return d=d||{},_.extend({source:b,target:c,sourcename:a(b),targetname:a(c)},d)},d.generate=function(a,b,c){var e,f,g,h,i=function(a){return e[a].name};switch(a){case"clique":case"cliquestf":for(e=new Array(b),f=[],g=0;b>g;++g)for(e[g]=d.node_object(g,{circle:"A"}),h=0;g>h;++h)f.push(d.edge_object(i,g,h,{notLayout:!0,undirected:!0}));if("cliquestf"===a)for(g=0;b>g;++g)e[g+b]=d.node_object(g+b),e[g+2*b]=d.node_object(g+2*b),f.push(d.edge_object(i,g,g+b,{undirected:!0})),f.push(d.edge_object(i,g,g+2*b,{undirected:!0}));break;case"wheel":for(e=new Array(b),g=0;b>g;++g)e[g]=d.node_object(g);f=d.wheel_edges(i,_.range(b),15*b);break;default:throw new Error("unknown generation type "+a)}var j={nodes:e,links:f};c(null,j)},d.wheel_edges=function(a,b,c){for(var e=b.length,f=[],g=Math.floor(e/2),h=2*c*Math.sin(Math.PI/e),i=2*c*Math.sin(g*Math.PI/e),j=0;e>j;++j)f.push(d.edge_object(a,b[j],b[(j+1)%e],{distance:h}));for(j=0;e/2>j;++j)f.push(d.edge_object(a,b[j],b[(j+g)%e],{distance:i})),e%2&&j!=Math.floor(e/2)&&f.push(d.edge_object(a,b[j],b[(j+e-g)%e],{distance:i}));return f},d.d3=a,d.crossfilter=b,d.dc=c,d}if("function"==typeof define&&define.amd)define(["d3","crossfilter","dc"],a);else if("object"==typeof module&&module.exports){var b=require("d3"),c=require("crossfilter");"function"!=typeof c&&(c=c.crossfilter);var d=require("dc");module.exports=a(b,c,d)}else this.dc_graph=a(d3,crossfilter,dc)}();
//# sourceMappingURL=dc.graph.min.js.map