/*!
 *  dc.graph 0.3.13
 *  http://dc-js.github.io/dc.graph.js/
 *  Copyright 2015-2016 AT&T Intellectual Property & the dc.graph.js Developers
 *  https://github.com/dc-js/dc.graph.js/blob/master/AUTHORS
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *
 */

!function(){function a(a,b,c){"use strict";function d(a,b,c){function d(a,b){return function(c,d){return a(c)?b(c):d()}}var e={};for(var f in c)/^node/.test(f)?a&&(e[f]=d(a,g(c[f]))):/^edge/.test(f)?b&&(e[f]=d(b,g(c[f]))):console.error('only know how to deal with properties that start with "node" or "edge"');return e}function e(a,b){return function(){return a(b.apply(null,arguments))}}function f(a){return a.orig}function g(a){return F.functor_wrap(a,f)}function h(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}function j(a,b,c){for(var d=["M",a[0].x,",",a[0].y],e=b,f=!1,g=1;g<a.length;++g)(isNaN(a[g].x)||isNaN(a[g].y))&&(f=!0),d.push(e===b?I[b]:" ",a[g].x,",",a[g].y),0===--e&&(e=b);return e!=b&&console.log("warning: pts.length didn't match bezian degree",a,b),c&&d.push("Z"),d.join("")}function k(a,b,c,d,e,f){function g(b){var f=c(b);a[f]||e(f,a[f]={},b);var g=a[f];return d(g,b),h[f]=!0,g}e||(e=function(){}),f||(f=function(){});var h={},i=b.map(g);for(var j in a)h[j]||(f(j,a[j]),delete a[j]);return i}function l(a,b,c,d){var e=Math.tan(Math.atan2(d,c));e*=e;var f={x:a*b/Math.sqrt(b*b+a*a*e),y:a*b/Math.sqrt(a*a+b*b/e)};return 0>c&&(f.x=-f.x),0>d&&(f.y=-f.y),f}function m(a,b,c){return b>=a-J&&c+J>=b}function n(a,b,c,d,e,f,g,h){var i=((a*d-b*c)*(e-g)-(a-c)*(e*h-f*g))/((a-c)*(f-h)-(b-d)*(e-g)),j=((a*d-b*c)*(f-h)-(b-d)*(e*h-f*g))/((a-c)*(f-h)-(b-d)*(e-g));if(isNaN(i)||isNaN(j))return!1;if(a>=c){if(!m(c,i,a))return!1}else if(!m(a,i,c))return!1;if(b>=d){if(!m(d,j,b))return!1}else if(!m(b,j,d))return!1;if(e>=g){if(!m(g,i,e))return!1}else if(!m(e,i,g))return!1;if(f>=h){if(!m(h,j,f))return!1}else if(!m(f,j,h))return!1;return{x:i,y:j}}function o(a,b,c,d,e){for(var f=0;f<a.length;++f){var g=f===a.length-1?0:f+1,h=n(a[f].x,a[f].y,a[g].x,a[g].y,b,c,d,e);if(h)return h}return null}function p(a,b,c,d){switch(b.dcg_shape.shape){case"ellipse":return l(b.dcg_rx,b.dcg_ry,c,d);case"polygon":return o(b.dcg_points,0,0,c,d)}}function q(a){var b=a.shape;if("random"===a.shape){var c=Object.keys(K);b=a._shape=c[Math.floor(Math.random()*c.length)]}return(K[b]||function(){throw new Error("unknown shape "+a.shape)})(a)}function r(a){return function(b){var c=a.nodeShape.eval(b)||L;b.dcg_shape=q(c),b.dcg_shape["abstract"]=c}}function s(a){return function(b){var c=a.nodeShape.eval(b)||L,d=b.dcg_shape["abstract"];return c.shape!==d.shape?!0:"polygon"===c.shape?c.shape.sides!==d.sides||c.shape.skew!==d.skew||c.shape.distortion!==d.distortion||c.shape.rotation!==d.rotation:!1}}function t(){return function(a){var b,c=a.dcg_shape.shape;switch(c){case"ellipse":b="ellipse";break;case"polygon":b="path";break;default:throw new Error("unknown shape "+c)}return document.createElementNS("http://www.w3.org/2000/svg",b)}}function u(a){return function(b){var c,d=a.nodeRadius.eval(b),e=2*d+a.nodePadding.eval(b)+a.nodeStrokeWidth.eval(b);a.nodeFitLabel.eval(b)&&(c=this.getBBox());var f=0;if(c&&c.width&&c.height){d=Math.max(d,c.height/2+5);var g=c.height/2/d,h=c.width/2/Math.sqrt(1-g*g);f=2*h+a.nodePadding.eval(b)+a.nodeStrokeWidth.eval(b),b.dcg_rx=Math.max(h,d),b.dcg_ry=d,"polygon"===b.dcg_shape.shape&&(b.dcg_rx/=Math.cos(Math.PI/(b.dcg_shape.sides||4)))}else b.dcg_rx=b.dcg_ry=d;b.cola.width=Math.max(f,e),b.cola.height=e}}function v(){return{rx:function(a){return a.dcg_rx},ry:function(a){return a.dcg_ry}}}function w(){return{d:function(a){var b=a.dcg_shape,c=b.sides||4,d=b.skew||0,e=b.distortion||0,f=b.rotation||0,g=c%2?0:.5,h=[];f=f/360+.25;for(var i=0;c>i;++i){var k=-((i+g)/c+f)*Math.PI*2,l=a.dcg_rx*Math.cos(k),m=a.dcg_ry*Math.sin(k);l*=1+e*((a.dcg_ry-m)/a.dcg_ry-1),l-=d*m/2,h.push({x:l,y:m})}return a.dcg_points=h,j(h,1,!0)}}}function x(b){return function(c){var d=a.select(this);switch(c.dcg_shape.shape){case"ellipse":d.attr(v(b,c));break;case"polygon":d.attr(w(b,c));break;default:throw new Error("unknown shape "+c.dcg_shape.shape)}}}function y(a,b,c){var d=100;if(a(b).val>=0)throw new Error("f(a) must be less than 0");if(a(c).val<=0)throw new Error("f(b) must be greater than 0");for(;;){if(!--d)throw new Error("patience ran out");var e=(b+c)/2,f=a(e),g=f.val;if(Math.abs(g)<.5)return f;g>0?c=e:b=e}}function z(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,q,r,s;if(h){var t,u,v=function(b,c){return p(a,b,1e3*Math.cos(c),1e3*Math.sin(c))},w=function(a,b,c){return function(d){var e=v(a,d);return e?{port:e,val:Math.hypot(e.x-b.x,e.y-b.y)-c,ang:d}:{port:{x:0,y:0},val:0,ang:d}}},x=Math.atan2(h.sourcePort.y,h.sourcePort.x),z=Math.atan2(h.targetPort.y,h.targetPort.x);try{t=y(w(b,h.sourcePort,j),x,x+2*i*j/k)}catch(A){t={ang:x,port:h.sourcePort}}try{u=y(w(c,h.targetPort,j),z,z-2*i*j/k)}catch(A){u={ang:z,port:h.targetPort}}o=t.port,q=u.port;var B=Math.hypot(o.x,o.y),C=Math.hypot(q.x,q.y),D=B+k/2,E=C+l/2,F=d+D*Math.cos(t.ang),G=e+D*Math.sin(t.ang),H=f+E*Math.cos(u.ang),I=g+E*Math.sin(u.ang);r=[{x:d+o.x,y:e+o.y},{x:F,y:G},{x:H,y:I},{x:f+q.x,y:g+q.y}],s=3}else m=f-d,n=g-e,o=p(a,b,m,n),q=p(a,c,-m,-n),o||(o={x:0,y:0}),q||(q={x:0,y:0}),r=[{x:d+o.x,y:e+o.y},{x:f+q.x,y:g+q.y}],s=1;return{sourcePort:o,targetPort:q,points:r,bezDegree:s}}function A(a,b){for(var c=[],d=1;d<a.length;d++){var e=a[d-1],f=a[d];c.push({x:e.x+(f.x-e.x)*b,y:e.y+(f.y-e.y)*b})}return c}function B(a,b){for(var c=[a],d=1;d<a.length;d++)c.push(A(c[c.length-1],b));return c}function C(a,b){var c=B(a,b);return c[c.length-1][0]}function D(a){var b=function(){return{type:"alignment",axis:a}};return b.listname="offsets",b.wrap=function(a){return{node:a,offset:0}},b}function E(a){return(a.nodes||a.vertices)&&(a.edges||a.links)}var F={version:"0.3.13",constants:{CHART_CLASS:"dc-graph"}},G=function(a,b){void 0===b?b=f:b===!1&&(b=H);var c=a,d=null,e=[],g=function(a){return arguments.length?(d&&d(a),c=a,this):c};return g.cascade=function(a,b){for(var c=0;c<e.length;++c){if(e[c].n===a)return b?e[c].f=b:delete e[c],g;if(e[c].n>a)return e.splice(c,0,{n:a,f:b}),g}return e.push({n:a,f:b}),g},g._eval=function(a,c){if(0!==c&&e.length){var d=e[c-1];return d.f(a,function(){return g._eval(a,c-1)})}return F.functor_wrap(g(),b)(a)},g.eval=function(a){return g._eval(a,e.length)},g.react=function(a){return arguments.length?(d=a,this):d},g},H=function(a){return a};F.functor_wrap=function(a,b){return"function"==typeof a?b?function(c){return a(b(c))}:a:function(){return a}};var I={1:"L",2:"Q",3:"C"};Math.hypot=Math.hypot||function(){for(var a=0,b=arguments.length,c=0;b>c;c++){if(arguments[c]===1/0||arguments[c]===-(1/0))return 1/0;a+=arguments[c]*arguments[c]}return Math.sqrt(a)},F.depth_first_traversal=function(a,b,c,d,e,f,g,h,i){return function(j,k,l){function m(a,b){var c=j.nodeKey.eval(a);return r[c]?void(i&&i(a,o[c])):(q[b]||(q[b]=[]),e&&e(a,b,q[b]),q[b].push(a),r[c]=!0,p[c]&&p[c].forEach(function(a,d){d&&f&&f(!1,p[c][d-1].target,a.target),g&&g(),m(a.target,b+1)}),void(h&&h(a)))}a&&a(),d&&(l=l.filter(function(a){return d(a.orig)}));var n,o={},p=l.reduce(function(a,b){var c=j.edgeSource.eval(b),d=j.edgeTarget.eval(b);return a[c]||(a[c]=[]),a[c].push(b),o[d]=(o[d]||0)+1,a},{}),q=[],r={};n=k.filter(b?function(a){return b(a.orig)}:function(a){return!o[j.nodeKey.eval(a)]}),n.forEach(function(a,b){b&&f&&f(!0,n[b-1],a),g&&g(),m(a,c?c(a.orig):0)})}};var J=1e-7,K={ellipse:function(){return{shape:"ellipse"}},egg:function(){return{shape:"polygon",sides:100,distortion:-.25}},triangle:function(){return{shape:"polygon",sides:3}},rectangle:function(){return{shape:"polygon",sides:4}},diamond:function(){return{shape:"polygon",sides:4,rotation:45}},trapezium:function(){return{shape:"polygon",sides:4,distortion:-.5}},parallelogram:function(){return{shape:"polygon",sides:4,skew:.5}},pentagon:function(){return{shape:"polygon",sides:5}},hexagon:function(){return{shape:"polygon",sides:6}},septagon:function(){return{shape:"polygon",sides:7}},octagon:function(){return{shape:"polygon",sides:8}},invtriangle:function(){return{shape:"polygon",sides:3,rotation:180}},invtrapezium:function(){return{shape:"polygon",sides:4,distortion:.5}},square:function(){return{shape:"polygon",sides:4}},polygon:function(a){return{shape:"polygon",sides:a.sides,skew:a.skew,distortion:a.distortion,rotation:a.rotation}}},L={shape:"ellipse"};return F.diagram=function(d,h){function i(){ea||(ea=new Worker("js/dc.graph."+$.layoutAlgorithm()+".worker.js"));var a={width:$.width(),height:$.height()};switch($.layoutAlgorithm()){case"cola":Object.assign(a,{handleDisconnected:$.handleDisconnected(),lengthStrategy:$.lengthStrategy(),baseLength:$.baseLength(),flowLayout:$.flowLayout(),tickSize:$.tickSize()});break;case"dagre":Object.assign(a,{rankdir:$.rankdir()})}ea.postMessage({command:"init",args:a})}function l(a){return!!a.source&&!!a.target}function m(){return"none"!==$.stageTransitions()?$.transitionDuration()/2:$.transitionDuration()}function n(a){return"none"===$.stageTransitions()||"modins"===$.stageTransitions()==!a?0:$.transitionDuration()/2}function o(b,c){c.attr("stroke",$.edgeStroke.eval).attr("stroke-width",$.edgeStrokeWidth.eval).attr("marker-end",function(a){var b=$.edgeArrowhead.eval(a),c=O(a,"head",b);return c?"url(#"+c+")":null}).attr("marker-start",function(a){var b=$.edgeArrowtail.eval(a),c=O(a,"tail",b);return b?"url(#"+c+")":null}).each(function(b){a.selectAll("#"+$.arrowId(b,"head")+",#"+$.arrowId(b,"tail")).attr("fill",$.edgeStroke.eval(b))}),$._updateNode(b)}function p(a){fa.end(a),la=!1,oa&&(oa=!1,window.setTimeout(function(){$.isRunning()||$.redraw()},0))}function q(a,b,c,d,e,f){if(!a.ports[b]){var g=a.source.dcg_ry+$.nodeStrokeWidth.eval(a.source)/2,h=a.target.dcg_ry+$.nodeStrokeWidth.eval(a.target)/2;a.ports[b]=new Array(a.ports.n);for(var i=a.ports.rev[a.parallel],j=0;j<a.ports.n;++j){var k=!!(j%2)==e>c?-1:1,l=Math.floor((j+1)/2),m=l?a.ports[b][j>2?j-2:0].path:null,n=z($,a.source,a.target,c,d,e,f,m,k,$.parallelEdgeOffset(),g,h);a.ports.rev[j]!==i&&n.points.reverse();var o=(n.points[0],n.points[n.points.length-1]),p=C(n.points,.75);a.ports[b][j]={path:n,orient:Math.atan2(o.y-p.y,o.x-p.x)+"rad"}}}return a.ports[b][a.parallel].path}function v(a){q(a,"old",a.source.prevX||a.source.cola.x,a.source.prevY||a.source.cola.y,a.target.prevX||a.target.cola.x,a.target.prevY||a.target.cola.y)}function w(a){var b=q(a,"new",a.source.cola.x,a.source.cola.y,a.target.cola.x,a.target.cola.y),c=b.points[0],d=b.points[b.points.length-1];a.length=Math.hypot(d.x-c.x,d.y-c.y)}function y(a){return function(b){var c=b.ports[a][b.parallel].path;return j(c.points,c.bezDegree)}}function A(a){return function(b){var c=b.ports[a][b.parallel].path,d=b.target.cola.x<b.source.cola.x?c.points.slice(0).reverse():c.points;return j(d,c.bezDegree)}}function B(a,b){a.every(function(a){return 0===a.size()})&&b();var c=0;a.forEach(function(a){a.each(function(){++c}).each("end.all",function(){--c||b()})})}function D(a){return{left:a.cola.x-a.dcg_rx,top:a.cola.y-a.dcg_ry,right:a.cola.x+a.dcg_rx,bottom:a.cola.y+a.dcg_ry}}function E(a,b){return{left:Math.min(a.left,b.left),top:Math.min(a.top,b.top),right:Math.max(a.right,b.right),bottom:Math.max(a.bottom,b.bottom)}}function I(a){return{left:a.x,top:a.y,right:a.x,bottom:a.y}}function J(a){var b=a.ports["new"][a.parallel].path.points;return b.map(I).reduce(E)}function K(a){var b=ba.selectAll("rect.bounds").data([0]);b.enter().insert("rect",":first-child").attr({"class":"bounds",fill:"rgba(128,255,128,0.1)",stroke:"#000"}),b.attr({x:a.left,y:a.top,width:a.right-a.left,height:a.bottom-a.top})}function M(a,b){if($.fitStrategy()&&a.size()){var c=a.data().map(D).reduce(E);if(c=b.data().map(J).reduce(E,c),!c)return;var d=c.right-c.left,e=c.bottom-c.top,f=$.width(),g=$.height();$.DEBUG_BOUNDS&&K(c);var h,i,j=$.fitStrategy(),k=[0,0],l=1;if(["default","vertical","horizontal"].indexOf(j)>=0){var m=g/f,n=e/d,o=m>n;"default"===j?(i=!o,h=null):(i="vertical"===j,h="xMidYMid "+(o^i?"meet":"slice")),k=[$.margins().left,$.margins().top],l=i?(g-$.margins().top-$.margins().bottom)/g:(f-$.margins().left-$.margins().right)/f}else if("function"==typeof j)h=j(d,e,f,g);else{if("string"!=typeof j)throw new Error("unknown fitStrategy type "+typeof j);h=$.fitStrategy()}_.attr({viewBox:[c.left,c.top,d,e].join(" "),preserveAspectRatio:h}),V.translate(k).scale(l).event(_)}}function N(b,c,d,e,f,g,h,i,j,k){console.assert(d.data().every(l));var o={};c.each(function(a){o[$.nodeKey.eval(a)]=!0}).attr("transform",function(a){return"translate("+a.cola.x+","+a.cola.y+")"});var q=b.transition().duration(m()).delay(function(a){return n(o[$.nodeKey.eval(a)])}).attr("opacity",$.nodeOpacity.eval).attr("transform",function(a){return"translate("+a.cola.x+","+a.cola.y+")"}).each("end.record",function(a){a.prevX=a.cola.x,a.prevY=a.cola.y});d.each(function(a){a.ports["new"]=null,a.ports.old=null});var r={};e.each(function(a){r[$.edgeKey.eval(a)]=!0}).each(function(b){var c;"modins"===$.stageTransitions()?(w(b),c="new"):(v(b),c="old"),$.edgeArrowhead.eval(b)&&a.select("#"+$.arrowId(b,"head")).attr("orient",function(){return b.ports[c][b.parallel].orient})}).attr("d",y("modins"===$.stageTransitions()?"new":"old"));var s=d.each(w).each(function(b){$.edgeArrowhead.eval(b)&&a.select("#"+$.arrowId(b,"head")).transition().duration(m()).delay(n(!1)).attr("orient",function(){return b.ports["new"][b.parallel].orient})}).transition().duration(m()).delay(function(a){return n(r[$.edgeKey.eval(a)])}).attr("opacity",$.edgeOpacity.eval).attr("d",function(a){var b="insmod"===$.stageTransitions()&&r[$.edgeKey.eval(a)]?"old":"new";return y(b)(a)});k.attr("d",A("modins"===$.stageTransitions()?"new":"old"));var t=j.transition().duration(m()).delay(function(a){return n(r[$.edgeKey.eval(a)])}).attr("opacity",$.edgeOpacity.eval).attr("d",function(a){var b="insmod"===$.stageTransitions()&&r[$.edgeKey.eval(a)]?"old":"new";return A(b)(a)});"insmod"===$.stageTransitions()&&(m()>=50?(s=s.transition().duration(m()).attr("d",y("new")),t=t.transition().duration(m()).attr("d",A("new"))):(s.attr("d",y("new")),t.attr("d",y("new")))),$.showLayoutSteps()||B([q,s,t],function(){p(!0)}),f.attr("d",y("new"))}function O(a,b,c){var d=$.arrowId(a,b),e=$.addOrRemoveDef(d,!!c,"svg:marker");return c&&e.attr("viewBox","0 -5 10 10").attr("refX",ka[c].refX).attr("refY",ka[c].refY).attr("markerUnits","userSpaceOnUse").attr("markerWidth",ka[c].width*$.edgeArrowSize.eval(a)).attr("markerHeight",ka[c].height*$.edgeArrowSize.eval(a)).attr("stroke",$.edgeStroke.eval(a)).attr("fill",$.edgeStroke.eval(a)).call(ka[c].drawFunction),c?d:null}function P(a,b){ma=a,na=b,ba.attr("transform","translate("+a+") scale("+b+")")}function Q(){P(a.event.translate,a.event.scale)}function R(a,b){_&&_.attr("width",a||$.width()).attr("height",b||$.height())}function S(){return _=$.root().append("svg"),R(),aa=_.append("svg:defs"),$.mouseZoomable()&&(W=a.scale.linear(),X=a.scale.linear(),V=a.behavior.zoom().on("zoom",Q).x(W).y(X),_.call(V),_.on("dblclick.zoom",null)),_}var T,U,V,W,X,Y,Z,$=c.marginMixin({}),_=null,aa=null,ba=null,ca=null,da=null,ea=null,fa=a.dispatch("end","start","drawn"),ga={},ha={},ia={},ja={},ka={},la=!1,ma=[0,0],na=1;$.width=G(200).react(function(a){R(a,0)}),$.height=G(200).react(function(a){R(0,a)}),$.root=G(null).react(function(a){a.empty()&&console.log("Warning: parent selector "+d+" doesn't seem to exist")}),$.mouseZoomable=G(!0),$.fitStrategy=G("default"),$.autoZoom=G(null),$.zoomToFit=function(){if(ca&&da){var a=ca.selectAll(".node"),b=da.selectAll(".edge");M(a,b)}},$.nodeDimension=G(),$.nodeGroup=G(),$.edgeDimension=G(),$.edgeGroup=G(),$.nodeKey=$.nodeKeyAccessor=G(function(a){return a.key}),$.edgeKey=$.edgeKeyAccessor=G(function(a){return a.key}),$.edgeSource=$.sourceAccessor=G(function(a){return a.value.sourcename}),$.edgeTarget=$.targetAccessor=G(function(a){return a.value.targetname}),$.nodeRadius=$.nodeRadiusAccessor=G(25),$.nodeStrokeWidth=$.nodeStrokeWidthAccessor=G(1),$.nodeStroke=$.nodeStrokeAccessor=G("black"),$.nodeFillScale=G(null),$.nodeFill=$.nodeFillAccessor=G("white"),$.nodeOpacity=G(1),$.nodePadding=G(6),$.nodeLabel=$.nodeLabelAccessor=G(function(a){return a.value.label||a.value.name}),$.nodeLabelFill=$.nodeLabelFillAccessor=G(null),$.nodeFitLabel=$.nodeFitLabelAccessor=G(!0),$.nodeShape=G(L),$.nodeTitle=$.nodeTitleAccessor=G(function(a){return $.nodeKeyAccessor()(a)}),$.nodeOrdering=G(null),$.nodeFixed=$.nodeFixedAccessor=G(null),$.edgeStroke=$.edgeStrokeAccessor=G("black"),$.edgeStrokeWidth=$.edgeStrokeWidthAccessor=G(1),$.edgeOpacity=$.edgeOpacityAccessor=G(1),$.edgeLabel=$.edgeLabelAccessor=G(function(a){return $.edgeKey()(a)}),$.edgeArrowhead=$.edgeArrowheadAccessor=G("vee"),$.edgeArrowtail=$.edgeArrowtailAccessor=G(null),$.edgeArrowSize=G(1),$.edgeIsLayout=$.edgeIsLayoutAccessor=G(function(a){return!a.value.notLayout}),$.edgeIsShown=$.edgeIsLayoutAccessor=G(!0),$.lengthStrategy=G("symmetric"),$.edgeLength=$.edgeDistanceAccessor=G(function(a){return a.value.distance}),$.flowLayout=G(null),$.rankdir=G("TB"),$.baseLength=G(30),$.transitionDuration=G(500),$.stageTransitions=G("none"),$.deleteDelay=G(0),$.groupConnected=G(!1),$.timeLimit=G(0),$.constrain=G(function(){return[]}),$.parallelEdgeOffset=G(10),$.edgeOrdering=G(null),$.cascade=function(a,b,c){for(var d in c){if(!$[d])throw new Error("unknown attribute "+d);$[d].cascade(a,b?c[d]:null)}return $},$.initLayoutOnRedraw=G(!1),$.layoutUnchanged=G(!1),$.relayout=function(){return T=U=null,this},$.initialLayout=G(null),$.initialOnly=G(!1),$.induceNodes=G(!1),$.showLayoutSteps=G(!1),$.legend=G(null).react(function(a){a.parent($)}),$.child=function(a,b){return 1===arguments.length?ja[a]:ja[a]===b?$:(ja[a]&&ja[a].parent(null),ja[a]=b,b&&b.parent($),$)},$.layoutAlgorithm=G("cola"),$.tickSize=G(1),$.edgeId=function(a){return"edge-"+$.edgeKey.eval(a).replace(/[^\w-_]/g,"-")},$.arrowId=function(a,b){return"arrow-"+b+"-"+$.edgeId(a)},$.textpathId=function(a){return"textpath-"+$.edgeId(a)},$.getNode=function(a){return ga[a]?ga[a].orig:null},$.handleDisconnected=G(!0),$._enterNode=function(a){return $.nodeTitle()&&a.append("title"),a.each(r($)),a.append(t($)).attr("class","node-shape"),a.append("text").attr("class","node-label"),$},$._updateNode=function(a){var b=a.filter(s($));b.select(".node-shape").remove(),b.each(r($)),b.insert(t($),":first-child").attr("class","node-shape"),a.select("title").text($.nodeTitle.eval);var c=a.select("text.node-label"),d=c.selectAll("tspan").data(function(a){var b=$.nodeLabel.eval(a);if(!b)return[];"string"==typeof b&&(b=[b]);var c=b.length%2?.3-(b.length-1)/2:1-b.length/2;return b.map(function(a,b){return{line:a,ofs:(0==b?c:1)+"em"}})});return d.enter().append("tspan").attr("x",0).attr("dy",function(a){return a.ofs}),d.text(function(a){return a.line}),d.exit().remove(),c.attr("fill",$.nodeLabelFill.eval).each(u($)),a.select(".node-shape").each(x($)).attr({stroke:$.nodeStroke.eval,"stroke-width":$.nodeStrokeWidth.eval,fill:e($.nodeFillScale()||H,$.nodeFill.eval)}),$},$.isRunning=function(){return la};var oa=!1;return $.redraw=function(){return la?(oa=!0,this):$.startLayout()},$.startLayout=function(){function c(a,b){a.forEach(function(a){var b=ga[a.dcg_nodeKey];b.cola.x=a.x,b.cola.y=a.y}),b.forEach(function(a){ha[a.dcg_edgeKey]})}var d=$.nodeGroup().all(),e=$.edgeGroup().all();if(la)throw new Error("dc_graph.diagram.redraw already running!");la=!0,ea&&ea.postMessage({command:"stop"}),$.initLayoutOnRedraw()&&i(),$.nodeOrdering()&&(d=b.quicksort.by($.nodeOrdering())(d.slice(0),0,d.length)),$.edgeOrdering()&&(e=b.quicksort.by($.edgeOrdering())(e.slice(0),0,e.length));var h=k(ga,d,function(a){return $.nodeKey()(a)},function(a,b){a.orig=b,a.cola=a.cola||{},a.cola.dcg_nodeKey=$.nodeKey.eval(a),$.nodeFixed()&&(a.cola.dcg_nodeFixed=$.nodeFixed.eval(a))}),j=k(ha,e,function(a){return $.edgeKey()(a)},function(a,b){a.orig=b,a.cola=a.cola||{},a.cola.dcg_edgeKey=$.edgeKey.eval(a),a.cola.dcg_edgeSource=$.edgeSource.eval(a),a.cola.dcg_edgeTarget=$.edgeTarget.eval(a),a.source=ga[a.cola.dcg_edgeSource],a.target=ga[a.cola.dcg_edgeTarget],a.cola.dcg_edgeLength=$.edgeLength.eval(a)});if(j=j.filter(l),j=j.filter(function(a){return a.source!==a.target}),j=j.filter($.edgeIsShown.eval),$.induceNodes()){var n={};j.forEach(function(a){n[a.cola.dcg_edgeSource]=!0,n[a.cola.dcg_edgeTarget]=!0}),h=h.filter(function(a){return n[a.cola.dcg_nodeKey]});for(var q in ga)n[q]||delete ga[q]}if(h.forEach(function(a,b){a.index=b}),ia={nnodes:h.length,nedges:j.length},$.parallelEdgeOffset()){for(var r=new Array(h.length),s=0;s<r.length;++s){r[s]=new Array(r.length);for(var t=0;t<r.length;++t)r[s][t]={n:0,ports:{rev:[]}}}for(j.forEach(function(a){var b=Math.min(a.source.index,a.target.index),c=Math.max(a.source.index,a.target.index);a.parallel=r[b][c].n++,a.ports=r[b][c].ports,a.ports.rev.push(b!==a.source.index)}),s=0;s<r.length;++s)for(t=0;t<r.length;++t)r[s][t].n&&(r[s][t].ports.n=r[s][t].n)}var u=da.selectAll(".edge").data(j,$.edgeKey.eval),v=u.enter().append("svg:path").attr({"class":"edge",id:$.edgeId,opacity:0});u.exit().transition().duration(m()).delay($.deleteDelay()).attr("opacity",0).each(function(a){O(a,"head",null),O(a,"head",null)}).remove();var w=da.selectAll(".edge-hover").data(j,$.edgeKey.eval),x=w.enter().append("svg:path").attr("class","edge-hover").attr("opacity",0).attr("stroke","green").attr("stroke-width",10).on("mouseover",function(b){a.select("#"+$.edgeId(b)+"-label").attr("visibility","visible")}).on("mouseout",function(b){a.select("#"+$.edgeId(b)+"-label").attr("visibility","hidden")});w.exit().remove();var y=da.selectAll(".edge-label").data(j,$.edgeKey.eval),z=y.enter().append("text").attr("id",function(a){return $.edgeId(a)+"-label"}).attr("visibility","hidden").attr({"class":"edge-label","text-anchor":"middle",dy:-2}).append("textPath").attr("startOffset","50%").attr("xlink:href",function(a){var b=$.textpathId(a);return"#"+b}),A=aa.selectAll("path.edge-label-path").data(j,$.textpathId),B=A.enter().append("svg:path").attr({"class":"edge-label-path",id:$.textpathId});y.each(function(a){a.dcg_bbox=null}).selectAll("textPath").text(function(a){return $.edgeLabel.eval(a)}),y.exit().transition().duration(m()).delay($.deleteDelay()).attr("opacity",0).remove();var C=ca.selectAll(".node").data(h,$.nodeKey.eval),D=C.enter().append("g").attr("class","node").attr("opacity","0");$._enterNode(D),C.exit().transition().duration(m()).delay($.deleteDelay()).attr("opacity",0).remove(),fa.drawn(C,u,w),o(C,u),$.initialLayout()&&$.initialLayout()($,h,j);var E=!1;if(!$.layoutUnchanged()){var G=JSON.stringify(h.map(f)),H=JSON.stringify(j.map(f));G===T&&H===U&&(E=!0),T=G,U=H}var I=$.constrain()($,h,j);I.forEach(function(a){if(a.type)switch(a.type){case"alignment":a.offsets.forEach(function(a){a.node=ga[a.node].index});break;case"circle":a.nodes.forEach(function(a){a.node=ga[a.node].index})}else a.axis&&(a.left=ga[a.left].index,a.right=ga[a.right].index)});var J=j.filter($.edgeIsLayout.eval),K=(j.filter(function(a){return!$.edgeIsLayout.eval(a)}),I.filter(function(a){return"circle"===a.type}));I=I.filter(function(a){return"circle"!==a.type}),K.forEach(function(a){var b=(a.distance||4*$.baseLength())/(2*Math.sin(Math.PI/a.nodes.length)),c=a.nodes.map(function(a){return a.node}),d=function(a){return $.nodeKey.eval(h[a])},e=F.wheel_edges(d,c,b).map(function(a){var b={internal:a};return b.source=ga[a.sourcename],b.target=ga[a.targetname],b});J=J.concat(e)});var L=I.filter(function(a){return"ordering"===a.type});if(I=I.filter(function(a){return"ordering"!==a.type}),L.forEach(function(a){var c=a.nodes.map(function(a){return ga[a]});if(a.ordering){var d=b.quicksort.by(g(a.ordering));c=d(c,0,c.length)}var e;c.forEach(function(b,c){0===c?e=b:I.push({left:e.index,right:(e=b).index,axis:a.axis,gap:a.gap})})}),$.legend()&&$.legend().redraw(),E)return la=!1,fa.end(!1),this;var P=Date.now();return ea.onmessage=function(a){var b=a.data.args;switch(a.data.response){case"tick":var d=Date.now()-P;c(b.nodes,b.edges),$.showLayoutSteps()&&N(C,D,u,v,w,x,y,z,A,B),(oa||$.timeLimit()&&d>$.timeLimit())&&(console.log("cancelled"),ea.postMessage({command:"stop"}));break;case"end":$.showLayoutSteps()?p(!0):(c(b.nodes,b.edges),N(C,D,u,v,w,x,y,z,A,B));var e;switch($.autoZoom()){case"always":e=!0;break;case"once":e=!0,$.autoZoom(null);break;default:e=!1}e&&M(C,u);break;case"start":console.log("algo "+$.layoutAlgorithm()+" started."),fa.start()}},fa.start(),ea.postMessage({command:"data",args:{nodes:h.map(function(a){return a.cola}),edges:J.map(function(a){return a.cola}),constraints:I,opts:{groupConnected:$.groupConnected()}}}),ea.postMessage({command:"start",args:{initialUnconstrainedIterations:10,initialUserConstraintIterations:20,initialAllConstraintsIterations:20,initialOnly:$.initialOnly(),showLayoutSteps:$.showLayoutSteps()}}),this},$.refresh=function(b,c,d,e,f){b=b||ca.selectAll(".node"),c=c||da.selectAll(".edge"),o(b,c),d=d||da.selectAll(".edge-hover"),e=e||da.selectAll(".edge-label"),f=f||aa.selectAll("path.edge-label-path");var g=a.select(null);N(b,g,c,g,d,g,e,g,f,g)},$.render=function(){return $.initLayoutOnRedraw()||i(),$.resetSvg(),ba=_.append("g"),da=ba.append("g"),ca=ba.append("g"),$.legend()&&$.legend().render(),$.redraw()},$.on=function(a,b){return fa.on(a,b),this},$.getStats=function(){return ia},$.select=function(a){return $.root().select(a)},$.selectAll=function(a){return $.root()?$.root().selectAll(a):null},$.svg=function(a){return arguments.length?(_=a,$):_},$.resetSvg=function(){return $.select("svg").remove(),S()},$.redrawGroup=function(){c.redrawAll(h)},$.renderGroup=function(){c.renderAll(h)},$.defineArrow=function(a,b,c,d,e,f){return ka[a]={name:a,width:b,height:c,refX:d,refY:e,drawFunction:f},$},$.addOrRemoveDef=function(a,b,c){var d=b?[0]:[],e=aa.selectAll("#"+a).data(d),f=e.enter().append(c).attr("id",a);return e.exit().remove(),f},$.invertCoord=function(a){return[W.invert(a[0]),X.invert(a[1])]},$.defineArrow("vee",12,12,10,0,function(a){a.append("svg:path").attr("d","M0,-5 L10,0 L0,5 L3,0").attr("stroke-width","0px")}),$.defineArrow("dot",7,7,0,0,function(a){a.append("svg:circle").attr("r",5).attr("cx",5).attr("cy",0).attr("stroke-width","0px")}),$.anchor=function(b,d){if(!arguments.length)return Y;if(!b)throw new c.errors.BadArgumentException("parent must be defined");return Y=b.select&&b.classed?b.node():b,$.root(a.select(Y)),$.root().classed(F.constants.CHART_CLASS,!0),c.registerChart($,d),Z=d,$},$.anchorName=function(){var a=$.anchor();return a&&a.id?a.id:a&&a.replace?a.replace("#",""):"dc-graph"+$.chartID()},$.anchor(d,h)},F.legend=function(){var a,b={};return b.x=G(0),b.y=G(0),b.gap=G(5),b.nodeWidth=G(40),b.nodeHeight=G(40),b.exemplars=G({}),b.parent=G(null),b.redraw=function(){var c=b.parent().svg().selectAll("g.dc-graph-legend").data([0]);c.enter().append("g").attr("class","dc-graph-legend").attr("transform","translate("+b.x()+","+b.y()+")");var d=c.selectAll(".node").data(a,function(a){return a.name}),e=d.enter().append("g").attr("class","node");e.append("text").attr("dy","0.3em").attr("class","legend-label"),d.attr("transform",function(a,c){return"translate("+b.nodeWidth()/2+","+(b.nodeHeight()+b.gap())*(c+.5)+")"}),d.select("text.legend-label").attr("transform","translate("+(b.nodeWidth()/2+b.gap())+",0)").text(function(a){return a.name}),b.parent()._enterNode(e)._updateNode(d)},b.render=function(){var c=b.exemplars();if(c instanceof Array)a=c.map(function(a){return{name:a.name,orig:{key:a.key,value:a.value},cola:{}}});else{a=[];for(var d in c)a.push({name:d,orig:{key:d,value:c[d]},cola:{}})}b.redraw()},b},F.constraint_pattern=function(a){var b={},c=[];return a.nodes.forEach(function(a){var c=a.id,d=b[c]||(b[c]={});if(a.partition){var e=a.partition,f=a.value||a.id;a.all||a.typename?(d.match=a.extract?function(b){return a.extract(b.value[e])}:function(a){return a.value[e]},d.typename=a.typename||function(a){return e+"="+a.value[e]}):d.match=function(a){return a.value[e]===f}}else{if(!a.match)throw new Error("couldn't determine matcher for type "+JSON.stringify(a));d.match=a.match}}),a.edges.forEach(function(a){if(!a.disable){var b={source:a.source,target:a.target};b.produce="function"==typeof a.produce?a.produce:function(){return h(a.produce)},["listname","wrap","reverse"].forEach(function(c){void 0!==a[c]&&(b[c]=a[c])}),c.push(b)}}),function(a,d,e){var f=[],g={};d.forEach(function(c){var d=a.nodeKey.eval(c);for(var e in b){var f=b[e],h=f.match(c.orig);if(h){var i=f.typename?f.typename(e,h):e;g[i]||(g[i]={nodes:[],whether:{}}),g[i].nodes.push(d),g[i].whether[d]=!0}}});var h=c.filter(function(a){return a.source!==a.target}),i=c.filter(function(a){return a.source===a.target});return e.forEach(function(b){var c=a.edgeSource.eval(b),i=a.edgeTarget.eval(b);h.forEach(function(a){if(g[a.source]&&g[a.source].whether[c]&&g[a.target]&&g[a.target].whether[i]){var b=a.produce(g,d,e);a.reverse?(b.left=i,b.right=c):(b.left=c,b.right=i),f.push(b)}})}),i.forEach(function(a){if(g[a.source]){var b=a.produce(),c=a.listname||a.produce.listname||"nodes",d=a.wrap||a.produce.wrap||function(a){return a};b[c]=g[a.source].nodes.map(d),f.push(b)}}),f}},F.gap_y=function(a,b){return{axis:"y",gap:a,equality:!!b}},F.gap_x=function(a,b){return{axis:"x",gap:a,equality:!!b}},F.align_y=function(){return D("y")},F.align_x=function(){return D("x")},F.order_x=function(a,b){return{type:"ordering",axis:"x",gap:60,ordering:b}},F.order_y=function(a,b){return{type:"ordering",axis:"y",gap:60,ordering:b}},F.tree_constraints=function(a,b,c){return function(d,e,f){var g=[],h=0,i=F.depth_first_traversal(null,a,null,b,function(a,b,c){if(c.length){var e=c[c.length-1];g.push({left:d.nodeKey.eval(e),right:d.nodeKey.eval(a),axis:"x",gap:h-e.foo_x,equality:!0})}a.foo_x=h},function(){h+=c});return i(d,e,f),g}},F.tree_positions=function(b,c,d,e,f,g,h){var i;g=a.functor(g);var j=F.depth_first_traversal(function(){i=e},b,c,d,function(a,b,c){if(c.length){var d=c[c.length-1],e=(g(d)+g(a))/2;i=Math.max(i,d.left_x+e)}a.left_x=i,a.hit_ins=1,a.cola.y=b*h+f},function(a,b,c){var d=(g(b)+g(c))/2;a&&(d=1.5*d),i+=d},null,function(a){a.cola.x=(a.left_x+i)/2},function(a,b){a.cola.x=(a.hit_ins*a.cola.x+i)/++a.hit_ins,a.hit_ins===b&&delete a.hit_ins});return j},F.behavior=function(a,b){var c={};return c.parent=G(null).react(function(d){var e;if(d){var f=!0;e=d,d.on("drawn."+a,function(a,c,d){b.add_behavior(e,a,c,d),f&&b.first?(b.first(e,a,c,d),f=!1):b.rest&&b.rest(e,a,c,d)})}else c.parent()&&(e=c.parent(),e.on("drawn."+a,function(c,d,f){b.remove_behavior(e,c,d,f),e.on("drawn."+a,null)}));b.parent&&b.parent(d)}),c},F.tip=function(){function b(b){return function(c){var d=a.event.target,h=function(){f[b]()(c,function(a){g.show(a,d)})};f.delay()?(clearTimeout(e),e=setTimeout(h,f.delay())):h()}}function c(){e&&(clearTimeout(e),e=null),g.hide()}function d(d,e){g||(g=a.tip().attr("class","d3-tip").html(function(a){return"<span>"+a+"</span>"}).direction(f.direction()),f.parent().svg().call(g)),d.on("mouseover.tip",b("content")).on("mouseout.tip",c),e.on("mouseover.tip",b("content")).on("mouseout.tip",c)}var e,f={},g=null;return f.parent=G(null).react(function(a){a?a.on("drawn.tip",function(a,b,c){d(a,c)}):f.parent()&&f.parent().on("drawn.tip",null)}),f.direction=G("n"),f.content=G(function(a,b){b(f.parent()?f.parent().nodeTitle.eval(a):"")}),f.delay=G(0),f},F.tip.table=function(){var b=function(c,d){c=c.orig.value;var e=Object.keys(c).filter(a.functor(b.filter())).filter(function(a){return c[a]}),f=a.select(document.createElement("table")),g=f.selectAll("tr").data(e),h=g.enter().append("tr");h.append("td").text(function(a){return a}),h.append("td").text(function(a){return c[a]}),d(f.node().outerHTML)};return b.filter=G(!0),b},F.select_nodes=function(b){function c(c,e,h){c.cascade(50,!0,d(function(a){return g.indexOf(a.orig.key)>=0},null,b)),e.on("click.select-nodes",function(b){g=[c.nodeKey.eval(b)],c.refresh(e,h),f.node_set_changed(g),a.event.stopPropagation()}),c.svg().on("click.select-nodes",function(){g=[],c.refresh(e,h),f.node_set_changed(g)});var i=e.data().map(function(a){return a.orig.key;

}),j=g.length;g=g.filter(function(a){return i.indexOf(a)>=0}),g.length!==j&&f.node_set_changed(g)}function e(a,c){c.on("click.select-nodes",null),a.svg().on("click.select-nodes",null),a.cascade(50,!1,b)}var f=F.select_nodes_group("select-nodes-group"),g=[];return F.behavior("select-nodes",{add_behavior:c,remove_behavior:function(a,b,c){e(a,b,c)}})},F.select_nodes_group=function(b){return window.chart_registry.create_type("select-nodes",function(){return a.dispatch("node_set_changed")}),window.chart_registry.create_group("select-nodes",b)},F.highlight_neighbors=function(a){function b(a){a.each(function(a){a.dcg_highlighted=!1})}function c(c,e,f){c.cascade(100,!0,d(null,function(a){return a.dcg_highlighted},a)),e.on("mouseover.highlight-neighbors",function(a){f.each(function(b){b.dcg_highlighted=b.source===a||b.target===a}),c.refresh(e,f)}).on("mouseout.highlight-neighbors",function(){b(f),c.refresh(e,f)})}function e(c,d,e){d.on("mouseover.highlight-neighbors",null).on("mouseout.highlight-neighbors",null),b(e),c.cascade(100,!1,a)}return F.behavior("highlight-neighbors",{add_behavior:c,remove_behavior:function(a,b,c){e(a,b,c)}})},F.register_highlight_paths_group=function(b){return window.chart_registry.create_type("highlight-paths",function(){return a.dispatch("paths_changed","hover_changed","select_changed")}),window.chart_registry.create_group("highlight-paths",b)},F.highlight_paths=function(a,b,c,e){function f(){v.doRedraw()?v.parent().relayout().redraw():v.parent().refresh()}function g(a,b){r=a,s=b,t=u=null,f()}function h(a){a!==u&&(u=a,f())}function i(a){a!==t&&(t=a,f())}function j(){r={},s={}}function k(a){return function(b){return a.indexOf(b)>=0}}function l(a){var b=k(a);return function(a){return!b(a)}}function m(a,b){return a&&b?a.some(k(b)):!1}function n(a,b){return a?b?b.every(k(a))?a.filter(l(b)):a.concat(b.filter(l(a))):a:b}function o(e,f,g,h){e.cascade(200,!0,d(function(a){return!!r[e.nodeKey.eval(a)]},function(a){return!!s[e.edgeKey.eval(a)]},a)).cascade(300,!0,d(function(a){return m(r[e.nodeKey.eval(a)],t)},function(a){return m(s[e.edgeKey.eval(a)],t)},c)).cascade(400,!0,d(function(a){return m(r[e.nodeKey.eval(a)],u)},function(a){return m(s[e.edgeKey.eval(a)],u)},b)),f.on("mouseover.highlight-paths",function(a){q.hover_changed(r[e.nodeKey.eval(a)]||null)}).on("mouseout.highlight-paths",function(){q.hover_changed(null)}).on("click.highlight-paths",function(a){q.select_changed(n(t,r[e.nodeKey.eval(a)]))}),h.on("mouseover.highlight-paths",function(a){q.hover_changed(s[e.edgeKey.eval(a)]||null)}).on("mouseout.highlight-paths",function(){q.hover_changed(null)}).on("click.highlight-paths",function(a){q.select_changed(n(t,s[e.nodeKey.eval(a)]))})}function p(d,e,f,g){e.on("mouseover.highlight-paths",null).on("mouseout.highlight-paths",null).on("click.highlight-paths",null),g.on("mouseover.highlight-paths",null).on("mouseout.highlight-paths",null).on("click.highlight-paths",null),j(),d.cascade(200,!1,a).cascade(300,!1,c).cascade(400,!1,b)}var q=F.register_highlight_paths_group(e||"highlight-paths-group");a=a||{},b=b||{},c=c||{};var r={},s={},t=null,u=null,v=F.behavior("highlight-paths",{add_behavior:o,remove_behavior:function(a,b,c,d){return p(a,b,c,d),this},parent:function(a){var b=a.anchorName();q.on("paths_changed."+b,a?g:null),q.on("hover_changed."+b,a?h:null),q.on("select_changed."+b,a?i:null)}});return v.doRedraw=G(!1),v},F.expand_collapse=function(b,c,d,e){function f(a){var b=a.addOrRemoveDef("spike-gradient",!0,"linearGradient");b.attr({x1:"0%",y1:"0%",x2:"100%",y2:"0%",spreadMethod:"pad"}),b.selectAll("stop").data([[0,"black",1],[100,"black","0"]]).enter().append("stop").attr({offset:function(a){return a[0]+"%"},"stop-color":function(a){return a[1]},"stop-opacity":function(a){return a[2]}})}function g(a,b,c,d){var e;switch(c){case"out":e=function(b){return a.edgeSource.eval(b)===d};break;case"in":e=function(b){return a.edgeTarget.eval(b)===d};break;case"both":e=function(b){return a.edgeSource.eval(b)===d||a.edgeTarget.eval(b)===d}}return b.filter(e).size()}function h(a,b,c){if("both"===b)return function(a){return Math.PI*(2*a/c-.5)};var d,e=(c-1)*Math.PI/c;switch(a){case"LR":d=0;break;case"TB":d=Math.PI/2;break;case"RL":d=Math.PI;break;case"BT":d=-Math.PI/2}return"in"===b&&(d+=Math.PI),function(a){return d+e*(-.5+(c>1?a/(c-1):0))}}function i(a,b){var c=b.selectAll("g.spikes").data(function(a){return!a.dcg_expand_selected||a.dcg_expanded&&a.dcg_expanded[a.dcg_expand_selected.dir]?[]:[a]});c.exit().remove(),c.enter().insert("g",":first-child").classed("spikes",!0);var d=c.selectAll("rect.spike").data(function(b){for(var c=(a.nodeKey.eval(b),b.dcg_expand_selected.dir),d=b.dcg_expand_selected.n,e=h(a.rankdir(),c,d),f=Array(d),g=0;d>g;++g){var i=e(g);f[g]={a:180*i/Math.PI,x:Math.cos(i)*b.dcg_rx*.9,y:Math.sin(i)*b.dcg_ry*.9}}return f});d.enter().append("rect").classed("spike",!0).attr({width:25,height:3,fill:"url(#spike-gradient)",rx:1,ry:1,x:0,y:0,transform:function(a){return"translate("+a.x+","+a.y+") rotate("+a.a+")"}}),d.exit().remove()}function j(a,b,c){b.each(function(a){a.dcg_expand_selected=null}),i(a,b,c)}function k(a,b,c,d){return 1===g(a,b,d,c)}function l(a,b,c,d){if(1===c.length)return c[0];var e=a.root().node().getBoundingClientRect(),f=a.invertCoord([b.clientX-e.left,b.clientY-e.top]),g=f[0],h=f[1];switch(a.rankdir()){case"TB":return h>d.cola.y?"out":"in";case"BT":return h<d.cola.y?"out":"in";case"LR":return g>d.cola.x?"out":"in";case"RL":return g<d.cola.x?"out":"in"}throw new Error("unknown rankdir "+a.rankdir())}function m(f,h,m){function n(c){var d=l(f,a.event,e,c),j=f.nodeKey.eval(c);Promise.resolve(b(j,d)).then(function(a){var b={dir:d,n:a-g(f,m,d,j)};h.each(function(a){a.dcg_expand_selected=a===c?b:null}),i(f,h,m)})}function o(b){function g(){var a=l(f,j,e,b);b.dcg_expanded=b.dcg_expanded||{},b.dcg_expanded[a]?(d(f.nodeKey.eval(b),k.bind(null,f,m,a),a),b.dcg_expanded[a]=!1):(c(f.nodeKey.eval(b),a,"dblclick"===j.type),b.dcg_expanded[a]=!0),i(f,h,m),b.dcg_dblclk_timeout=null}var j=a.event;return console.log(j.type),g()}h.on("mouseover.expand-collapse",n).on("mousemove.expand-collapse",n).on("mouseout.expand-collapse",function(){j(f,h,m)}).on("click",o).on("dblclick",o)}function n(a,b){b.on("mouseover.expand-collapse",null).on("mouseout.expand-collapse",null),j(a,b)}if(e=e||["both"],e.length>2)throw new Error("there are only two directions to expand in");return F.behavior("expand-collapse",{add_behavior:m,first:f,remove_behavior:n})},F.load_graph=function(){function b(a){return a?a.replace(/\?.*/,""):null}var c,d,e;if(c=arguments[0],3===arguments.length)d=arguments[1],e=arguments[2];else{if(2!==arguments.length)throw new Error("need two or three arguments");e=arguments[1]}d?queue().defer(a.json,c).defer(a.json,d).await(function(a,b,c){a?e(a,null):e(null,{nodes:b.results,edges:c.results})}):/\.json$/.test(b(c))?a.json(c,e):/\.gv|\.dot$/.test(b(c))&&a.text(c,function(a,b){if(a)return void e(a,null);var c=graphlibDot.parse(b),d=c.nodes(),f=new Array(d.length);d.forEach(function(a,b){var e=f[b]=c._nodes[d[b]];e.id=b,e.name=a});var g=c.edges(),h=[];g.forEach(function(a){var b=c._edges[a];h.push({source:c._nodes[b.u].id,target:c._nodes[b.v].id,sourcename:b.u,targetname:b.v})});var i={nodes:f,links:h};e(null,i)})},F.munge_graph=function(a,b,c,d){function e(a,b){return b.filter(function(b){return!!a[b]})}var f,g,h=b||"name",i=c||"sourcename",j=d||"targetname";if(!E(a)){var k=["database","response"],l=k.findIndex(function(b){return a[b]&&E(a[b])});if(0>l)throw new Error("couldn't find the data!");a=a[k[l]]}g=a.edges||a.links,f=a.nodes||a.vertices;var m=g[0];if(void 0===m[i]){var n=c?[c]:["source_ecomp_uid","node1","source","tail"],o=d?[d]:["target_ecomp_uid","node2","target","head"],p=["edge"];if(m.node0&&m.node1)i="node0",j="node1";else{var q=e(m,n);if(!q.length){if(l=p.findIndex(function(a){return m[a]&&e(m[a],n).length}),0>l)throw new Error(c?"sourceattr "+i+" didn't work":"didn't find any source attr");g=g.map(function(a){return a[p[l]]}),m=g[0],q=e(m,n)}if(q.length>1&&console.warn("found more than one possible source attr",q),i=q[0],q=e(m,o),!q.length)throw new Error(d&&!m[d]?"targetattr "+j+" didn't work":"didn't find any target attr");q.length>1&&console.warn("found more than one possible target attr",q),j=q[0]}}var r=f[0];if(void 0===r[h]){var s=b?[b]:["ecomp_uid","id","_id"],t=["vertex"];if(q=e(r,s),!q.length){if(l=t.findIndex(function(a){return r[a]&&e(r[a],s).length}),0>l)throw new Error(b?"nodekeyattr "+h+" didn't work":"couldn't find the node data");f=f.map(function(a){return a[t[l]]}),r=f[0],q=e(r,s)}q.length>1&&console.warn("found more than one possible node key attr",q),h=q[0]}return{nodes:f,edges:g,nodekeyattr:h,sourceattr:i,targetattr:j}},F.flat_group=function(){function a(a){return{all:function(){return a.all().filter(function(a){return null!==a.value})}}}function c(b,c){var e=b.dimension(c);return{crossfilter:b,dimension:e,group:a(e.group().reduce(d.add,d.remove,d.init))}}var d={add:function(a,b){return b},remove:function(){return null},init:function(){return null}};return{make:function(a,d){var e=b(a);return c(e,d)},another:function(a,b){return c(a,b)}}}(),F.convert_nest=function(a,b,d,e,f,g,j){j=j||{};var k=Object.keys(j).length;if(b.length){var l=b.shift(),m=[],n=[],o=a.map(function(a){j[l]=a.key;var c=i(),o=h(j);if(o[d]=c,o.name=l+":"+a.key,o._level=k+1,m.push(o),g){var p={};p[e]=g,p[f]=c,n.push(p)}var q=F.convert_nest(a.values,b.slice(0),d,e,f,c,h(j));return q});return{nodes:Array.prototype.concat.apply(m,o.map(c.pluck("nodes"))),edges:Array.prototype.concat.apply(n,o.map(c.pluck("edges")))}}return{nodes:a.map(function(a){return a._level=k+1,a}),edges:a.map(function(a){var b={};return b[e]=g,b[f]=a[d],b})}},F.convert_adjacency_list=function(a,b,c){var d=Array.prototype.concat.apply([],a.map(function(a){return a[b.adjacencies].map(function(d){var e={};return c.edgeKey&&(e[c.edgeKey]=i()),e[c.edgeSource]=a[b.nodeKey],e[c.edgeTarget]=b.targetKey?d[b.targetKey]:d,c.adjacency&&(e[c.adjacency]=d),e})}));return{nodes:a,edges:d}},F.path_reader=function(a){function b(a,b,c){g.elementList.eval(a).forEach(function(d){var e,f;switch(g.elementType.eval(d)){case"node":e=g.nodeKey.eval(d),f=b[e]=b[e]||[];break;case"edge":e=g.edgeSource.eval(d)+"-"+g.edgeTarget.eval(d),f=c[e]=c[e]||[]}f.push(a)})}var c,d,e,f=F.register_highlight_paths_group(a||"highlight-paths-group"),g={pathList:G(H,!1),timeRange:G(null,!1),elementList:G(H,!1),elementType:G(null,!1),nodeKey:G(null,!1),edgeSource:G(null,!1),edgeTarget:G(null,!1),clear:function(){f.paths_changed({},{},[])},data:function(a){var h,i={},j={},k=[];g.pathList.eval(a).forEach(function(a){if(a._range=g.timeRange.eval(a)){if(h===!1)throw new Error("can't have a mix of ranged and non-ranged paths");h=!0}else{if(h===!0)throw new Error("can't have a mix of ranged and non-ranged paths");h=!1,b(a,i,j)}k.push(a)}),h?(c=k.map(function(a){var b=[a._range[0].getTime(),a._range[1].getTime()];return b.path=a,b}),d=lysenkoIntervalTree(c),e&&this.setTime(e)):(c=null,d=null,f.paths_changed(i,j,k))},getIntervals:function(){return c},setTime:function(a){if(a&&d){var c=[],g={},h={};d.queryPoint(a.getTime(),function(a){c.push(a.path),b(a.path,g,h)}),f.paths_changed(g,h,c)}e=a}};return g},F.path_selector=function(b,d,e,f){function g(a){return function(b){return a?a.indexOf(b)>=0:!1}}function h(a){var b=g(a);return function(a){return!b(a)}}function i(a,b){return a?b?b.every(g(a))?a.filter(h(b)):a.concat(b.filter(h(a))):a:b}function j(a){var b=n.selectAll("span.path-selector").data(a);b.enter().append("span").attr("class","path-selector").style({"border-width":"1px","border-style":"solid","border-color":"grey","border-radius":"4px",display:"inline-block",padding:"4px",cursor:"pointer",margin:"5px"}),b.exit().transition(1e3).attr("opacity",0).remove(),b.text(function(a,b){return"path "+(b+1)+" ("+d.elementList.eval(a).length+")"}).on("mouseover",function(a){m.hover_changed([a])}).on("mouseout",function(){m.hover_changed(null)}).on("click",function(a){m.select_changed(i(q,[a]))});var c=n.selectAll("span.no-paths").data(0===a.length?[0]:[]);c.exit().remove(),c.enter().append("span").attr("class","no-paths"),c.classed("error",!!r.error_text()).text(r.error_text()||(r.queried()?r.zero_text():r.default_text()))}function k(){var a=g(p);n.selectAll("span.path-selector").style({"border-color":function(b){return a(b)?"#e41a1c":"grey"},"border-width":function(b){return(a(b)?2:1)+"px"},padding:function(b){return(a(b)?3:4)+"px"}})}function l(){var a=g(q);n.selectAll("span.path-selector").style({"background-color":function(b){return a(b)?"#1c1ae6":"white"},color:function(b){return a(b)?"white":"black"}})}var m=F.register_highlight_paths_group(e||"highlight-paths-group"),n=a.select(b),o=[],p=null,q=null;m.on("paths_changed.selector",function(a,b,c){p=q=null,o=c,r.redraw()}).on("hover_changed.selector",function(a){p=a,k()}).on("select_changed.selector",function(a){q=a,l()});var r={default_text:G("Nothing here"),zero_text:G("No paths"),error_text:G(null),queried:G(!1),redraw:function(){j(o),k(),l()},render:function(){return this.redraw(),this}};return c.registerChart(r,f),r},F.node_name=function(a){if(26>a)return String.fromCharCode(97+a);if(52>a)return String.fromCharCode(65+a-26);if(2704>a)return F.node_name(Math.floor(a/52))+F.node_name(a%52);throw new Error("no, that's too large")},F.node_object=function(a,b){return b=b||{},_.extend({id:a,name:F.node_name(a)},b)},F.edge_object=function(a,b,c,d){return d=d||{},_.extend({source:b,target:c,sourcename:a(b),targetname:a(c)},d)},F.generate=function(a,b,c,d){var e,f,g,h,i=c.nodePrefix||"",j=function(a){return e[a].name},k=b[0],l=c.linkLength||30;switch(a){case"clique":case"cliquestf":for(e=new Array(k),f=[],g=0;k>g;++g)for(e[g]=F.node_object(g,{circle:"A",name:i+F.node_name(g)}),h=0;g>h;++h)f.push(F.edge_object(j,g,h,{notLayout:!0,undirected:!0}));if("cliquestf"===a)for(g=0;k>g;++g)e[g+k]=F.node_object(g+k),e[g+2*k]=F.node_object(g+2*k),f.push(F.edge_object(j,g,g+k,{undirected:!0})),f.push(F.edge_object(j,g,g+2*k,{undirected:!0}));break;case"wheel":for(e=new Array(k),g=0;k>g;++g)e[g]=F.node_object(g,{name:i+F.node_name(g)});f=F.wheel_edges(j,_.range(k),k*l/2);var m=f[0].distance;for(g=0;g<b[1];++g)for(h=0;k>h;++h)f.push(F.edge_object(j,h,(h+1)%k,{distance:m,par:g+2}));break;default:throw new Error("unknown generation type "+a)}var n={nodes:e,links:f};d(null,n)},F.wheel_edges=function(a,b,c){for(var d=b.length,e=[],f=Math.floor(d/2),g=2*c*Math.sin(Math.PI/d),h=2*c*Math.sin(f*Math.PI/d),i=0;d>i;++i)e.push(F.edge_object(a,b[i],b[(i+1)%d],{distance:g}));for(i=0;d/2>i;++i)e.push(F.edge_object(a,b[i],b[(i+f)%d],{distance:h})),d%2&&i!=Math.floor(d/2)&&e.push(F.edge_object(a,b[i],b[(i+d-f)%d],{distance:h}));return e},F.build_type_graph=function(a,b,c,d,e,f){var g={},h={},i={};return a.forEach(function(a){g[c(a)]=a;var b=d(a);h[b]||(h[b]={type:b})}),b.forEach(function(a){var b,c,h=e(a),j=f(a);if(!(b=g[h]))throw new Error("source key "+h+" not found!");if(!(c=g[j]))throw new Error("target key "+j+" not found!");var k=d(b)+"/"+d(c);i[k]||(i[k]={type:k,source:d(b),target:d(c)})}),{nodes:Object.keys(h).map(function(a){return h[a]}),edges:Object.keys(i).map(function(a){return i[a]})}},F.d3=a,F.crossfilter=b,F.dc=c,F}if("function"==typeof define&&define.amd)define(["d3","crossfilter","dc"],a);else if("object"==typeof module&&module.exports){var b=require("d3"),c=require("crossfilter");"function"!=typeof c&&(c=c.crossfilter);var d=require("dc");module.exports=a(b,c,d)}else this.dc_graph=a(d3,crossfilter,dc)}();
//# sourceMappingURL=dc.graph.min.js.map